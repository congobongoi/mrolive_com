<!DOCTYPE html>
{% load static %}
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MRO Live WO Management - Where Productivity Takes Flight</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="shortcut icon" type="image/png" href="{% static 'favicon.ico' %}"/>
    <link rel="stylesheet" href="{% static 'dist/assets/css/app.css' %}">
    <link href="{% static 'dist/assets/fontawesome/css/all.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2017.2.621/styles/kendo.common-material.min.css" />
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2017.2.621/styles/kendo.material.min.css" />
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2017.2.621/styles/kendo.material.mobile.min.css" />
    <script src="https://kendo.cdn.telerik.com/2020.1.114/js/jszip.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.4.0/jszip.js"></script>
    <script src="https://kendo.cdn.telerik.com/2017.2.621/js/jquery.min.js"></script>
    <script src="https://kendo.cdn.telerik.com/2017.2.621/js/kendo.all.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>	
	<script type="text/javascript" src="{% static 'jquery-1.12.4.js' %}"></script>
    <script type="text/javascript" src="{% static 'field_focus.js' %}"></script>
	<script src="{% static 'jquery.bootstrap.modal.forms.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'jquery_tab_submit.js' %}"></script>
	<script src="https://demos.telerik.com/kendo-ui/content/shared/js/console.js"></script>
	<style>
	    .subhead {
			color:white;
			text-decoration:bold;
			font-size: large;
            margin-left: 65px;
		}
        .k-pager-wrap .k-dropdown {
            width: 100px;	    
        }
		.k-grid-toolbar { 
			background-color:#284a8a !important;
			
		}
		.secondary.button::after {
		    content: none;
		}
		.button::after {
		    content: none;
		}
		.k-button {  
			border: 2px solid white;
			color: white;
			border-color: white !important;			
		}
		.k-button:hover {
		    color: yellow !important;
		}
		.k-button:visited {
		    color: white !important;
		}
		.centered {
		  /*top: 50%;*/
		  left: 50%;
		  height: 100%;
		  /* bring your own prefixes */
		  transform: translateX(-50%);
		}
		.total_rows {
		 padding-left:5px;
		 display:inline;
		 text-align:left;
		 border:none;
		 outline:none;
		 background-color:#284a8a!important;
		 color:white;
		 text-decoration:bold;
		 height:25px;
		 width: 45px;
		}
		.sel_rows {
        display:inline;
		text-align:right;
		border:none;
		outline:none;
		background-color:#284a8a!important;
		color:white;
		text-decoration:bold;
		height:25px;
		width: 55px;
		}
		.counter_wrap {
		width:auto;
		float:right;
		margin-top:-45px;
		margin-bottom: 5px;
		z-index:1000!important;
		color: white;
		}
		.save_buttons {
		margin-top: -45px;
	    padding-right: 5px;
		float:right;
		z-index:1000!important;
		}
    </style>
  </head>
  <body onload='setFocusWOOnLoad()'>
    <audio src="{% static 'error-trombone.mp3' %}" id="sad_trombone"></audio>
    <script type="text/javascript">
			$(document).ready(
				function () {
				$("#due_date").kendoDatePicker();
			    error = $("#error").val();
				if (error) {
                   $("#sad_trombone").get(0).play();
				}

		    })
    </script>
<div class="mro-header-wrapper">
	<section id="mrotop"></section>
	<div class="grid-container mro-header">
		<div class="grid-x medium-margin-collapse align-middle hide-for-medium" style="float:left;">
			<div class="cell large-1 medium-2 small-12 mro-menu-button">
				<a data-toggle="offCanvas"><i class="fas fa-bars"></i></a>
			</div>
			<div class="cell large-11 medium-10 small-12 show-for-medium"><hr/></div>
		</div>
		<div class="grid-x grid-padding-x align-middle">
			<div class="cell medium-7 small-12 mro-headerlogo">
				<a href="" alt="MRO Live - Homepage">
					<img style="max-width:361px;max-height:150px;" src="{% static 'dist/assets/img/mro-live_header.png' %}" alt="MROLive - Where Productivity Takes Flight">
				</a>
			</div>
			<!--div class="cell medium-5 small-12 mro-clientlogo show-for-medium">
				<a href="#" alt="MRO Live - Client Logo">
				  <img style="max-width:150px;" src="../../..{{ logo_url }}" alt="{{ user_name }}">
				</a>			
			</div-->
		</div>
		<div class="grid-x medium-margin-collapse align-middle show-for-medium">
			<div class="cell large-1 medium-2 small-12 mro-menu-button">
				<a data-toggle="offCanvas">Menu <i class="fas fa-bars"></i></a>
			</div>
			<div class="cell large-11 medium-10 small-12 show-for-medium"><hr/></div>
		</div>
		<!--div class="cell medium-7 small-12 mro-clientlogo hide-for-medium mro-mobileclient">
			  <a href="#" alt="MRO Live - Client Logo">
				<img style="max-width:150px;" src="../../..{{ logo_url }}" alt="{{ user_name }}">
			  </a>      
		</div-->
	</div>
</div>

<!-- Off-canvas Menu -->

<div class="off-canvas position-left" id="offCanvas" data-off-canvas>

<!-- Close button -->
<button class="close-button" aria-label="Close menu" type="button" data-close>
  <span aria-hidden="true">&times;</span>
</button>
<!-- Menu -->
<ul class="vertical mro-menu menu">
	<li class="mro-menu-logo">
		<a href="http://mrolive.com/" target="_blank">
			<img src="{% static 'dist/assets/img/MROlive-logo.png' %}" alt="Where Productivity Takes Flight" alt="MRO Live - Where Productivity Takes Flight">
		</a>
	</li>
	{% if op_apps %}
	<div class="subhead">Operations</div>
	{% endif %}
	{% for app in op_apps %}
      <li><a target="_blank" href="../{{ app.ml_apps_id.code }}/{{ quapi_id }}">{{ app.ml_apps_id.name }}</a></li>
    {% endfor %}
	{% if mgmt_apps %}
	<div class="subhead">Management</div>
	{% endif %}
	{% for app in mgmt_apps %}
      <li><a target="_blank" href="../{{ app.ml_apps_id.code }}/{{ quapi_id }}">{{ app.ml_apps_id.name }}</a></li>
    {% endfor %}
	{% if dash_apps %}
	<div class="subhead">Dashboards</div>
	{% endif %}
	{% for app in dash_apps %}
      <li><a target="_blank" href="../{{ app.ml_apps_id.code }}/{{ quapi_id }}">{{ app.ml_apps_id.name }}</a></li>
    {% endfor %}
	{% if setup_apps %}
	<div class="subhead">Setup</div>
	{% endif %}
	{% for app in setup_apps %}
      <li><a target="_blank" href="../{{ app.ml_apps_id.code }}/{{ quapi_id }}">{{ app.ml_apps_id.name }}</a></li>
    {% endfor %}
	<li><a href="/portal/pass-reset/">Reset Password</a></li>
    <li><a href="/login">Logout</a></li>
</ul>
</div>
<!-- Off-canvas Menu - END -->
    <div class="grid-container mro-top-section">
      <div class="grid-x grid-padding-x">
          <div class="mro-top-section-wrapper mro-search">
            <div class="mro-top-section" style="width:100%;">
			  <form method="POST" id="mgmt_form" name="mgmt_form" onsubmit='setFocusToTextBox()'> 
				  <input type="hidden" name="active_user" id="active_user" value="{{ user_id }}"/>
				  <input type="hidden" name="active_mgr" id="active_mgr" value="{{ manager }}"/>
				  <input type="hidden" name="active_due_date" id="active_due_date" value="{{ new_due_date }}"/>
				  <input type="hidden" name="active_rank" id="active_rank" value="{{ rank }}"/>
				  <input type="hidden" name="search_user" id="search_user" value="{{ search_user }}"/> 
				  <input type="hidden" name="clear_form" id="clear_form" value="0"/>
				  <input type="hidden" name="session_id" id="session_id" value="{{session_id}}"/>
				  <input type="hidden" name="show_status" id="show_status" value="{{ show_status }}"/>
				  <input type="hidden" name="show_user" id="show_user" value="{{show_user}}"/>
				  <input type="hidden" name="show_all" id="show_all" value="{{ show_all }}"/>
				  <input type="hidden" name="lookup_recs" id="lookup_recs" value="{{ lookup_recs}}"/>
				  <input type="hidden" name="status_key" id="status_key" value="0"/>
				  <input type="hidden" name="options_pagesize" id="options_pagesize"/>
				  <input type="hidden" name="options_col" id="options_col"/>
              <div class="mro-lightsearch">
			    <div class="medium-12 small-7 cell hide-for-medium">
				</div>
				<div class="medium-12 small-7 cell hide-for-medium">
				</div>
				<div class="cell large-4 medium-6 small-12">
				  <h1>WO Management</h1>
				  {%  if msg %}<div style="font-weight: bold; color:green; font-size: 12px;">{{ msg }}</div>{%  endif %}
				</div>
                <div class="grid-x grid-padding-x align-middle">
				    {% csrf_token %}
					<div class="cell large-4 medium-6 small-12">
                      <label>Customer</label>
					  {{ form.customer }}
                      <!--input type="text" id="customer" name="customer" value="{{ customer }}" placeholder="Bonaero LTD..." /-->  
                    </div>
				    <div class="cell large-4 medium-6 small-12">
                      <label>Status</label>
						<select name="new_status" id="new_status" style="background-color:#cacaca;">
							<option value=""> -- No Selection -- </option>
							{% for sstatus in status_vals %}						
							{% if sstatus.wos_auto_key == new_status %}
							<option value="{{ sstatus.wos_auto_key }}" selected>{{ sstatus.name }}</option>
							{% else %}
							<option value="{{ sstatus.wos_auto_key }}">{{ sstatus.name }}</option>
							{% endif %}							
							{% endfor %}
						</select>
					</div>
                    <div class="cell large-4 medium-6 small-12">
                      <label>Manager</label>
                      <!--input type="text" id="get_manager" name="get_manager" value="{{ get_manager }}" placeholder="ABLAKEY..." /-->
                      {{ form.get_manager }}					  
                    </div>
					<div class="cell large-4 medium-6 small-12">
					  <label>Part Number</label>
					  <!--input type="text" id="wo_number" name="wo_number" value="{{ wo_number }}" placeholder="10034-COR-02..." /-->
					  {{ form.part_number }}					  
					</div>
                    <div class="cell large-4 medium-6 small-12">
                      <label>Location</label>
                      <!--input type="text" id="get_due_date" name="get_due_date" value="{{ get_due_date }}" placeholder="01/23/2021..." /--> 
					  {{ form.location }}					  
                    </div>
                    <div class="cell large-4 medium-6 small-12">
                      <label>Warehouse</label>
                      <!--input type="text" id="get_due_date" name="get_due_date" value="{{ get_due_date }}" placeholder="01/23/2021..." /--> 
					  {{ form.warehouse }}					  
                    </div>
                    <div class="cell large-4 medium-6 small-12">
                      <label>Due Date</label>
                      <!--input type="text" id="get_due_date" name="get_due_date" value="{{ get_due_date }}" placeholder="01/23/2021..." /--> 
					  {{ form.get_due_date }}					  
                    </div>
                    <div class="cell large-4 medium-6 small-12">
                      <label>WO#</label>
                      <!--input type="text" id="wo_number" name="wo_number" value="{{ wo_number }}" placeholder="10034-COR-02..." /-->
                      {{ form.wo_number }}					  
                    </div>
				  <div class="large-4 small-12 cell">
					<div class="grid-x grid-padding-x align-middle mro-searchbuttonbox">
					  <div class="cell large-auto  medium-6 small-12 mro-searchbuttonbox">
						<input type="checkbox" name="exact_match" id="exact_match" value="1" {{ exact_match }}><label>Exact Match</label>
					  </div>
					  <div class="cell large-4 medium-6 small-12 mro-searchbuttonbox">
						<input class="primary button shadow" type="submit" value="Go" name="wo_search" id="wo_search" onclick="this.disabled=true,this.form.submit();"/>
					  </div>
					</div>
				  </div>
				  </div>
                </div>
			</div>
		  </form>
		  <form method="POST" id="upd_mgmt_form" name="upd_mgmt_form">
		    {% csrf_token %}
		  <input type="hidden" name="active_mode" id="active_mode" value="1"/>	
		  <input type="hidden" name="is_bom_sched" id="is_bom_sched" value="0"/>						  
		  <input type="hidden" name="filter_customer" id="filter_customer" value="{{ filter_customer }}"/>
		  <input type="hidden" name="filter_status" id="filter_status" value="{{ filter_status }}"/>
		  <input type="hidden" name="filter_due_date" id="filter_due_date" value="{{ filter_due_date }}"/>
		  <input type="hidden" name="filter_number" id="filter_number" value="{{ filter_number }}"/>
		  <input type="hidden" name="filter_manager" id="filter_manager" value="{{ filter_manager }}"/>
		  <input type="hidden" name="filter_session" id="filter_session" value="{{ filter_session }}"/>	
		  <input type="hidden" name="filter_location" id="filter_location" value="{{ filter_location }}"/>
		  <input type="hidden" name="filter_warehouse" id="filter_warehouse" value="{{ filter_warehouse }}"/>
		  <input type="hidden" name="update_pagesize" id="update_pagesize"/>
		  <input type="hidden" name="update_col" id="update_col"/>	
		  {% if all_woos %}
		  <div class="mro-darksearch">
			<div class="grid-x grid-padding-x">
				<div class="large-6 small-12 cell" style="width:100%;">
				  <div class="grid-x grid-padding-x align-middle">					  
					    <div class="cell large-6 medium-6 small-12">	
					      <label>Manager: </label> 
						  <!--input type="text" id="manager" name="manager" value="{{ manager }}" placeholder="CTERRY..." /-->
						  {{ form.manager }}
					    </div>
						<div class="cell large-6 medium-6 small-12">
						  <label>Due Date:</label>
						  <!--input type="text" id="due_date" name="due_date" value="{{ new_due_date }}" placeholder="01/23/2020..." /-->
						  {{ form.due_date }}
						</div>
					    <div class="cell large-6 medium-6 small-12">	
					      <label>Rank: </label>
						  <!--input type="text" id="rank" name="rank" value="{{ rank }}" placeholder="1234..." /-->
						  {{ form.rank }}
					    </div>
					    <div class="cell large-6 medium-6 small-12">	
					      <label>Manual ECD: </label>
						  <!--input type="text" id="rank" name="rank" value="{{ rank }}" placeholder="1234..." /-->
						  {{ form.arrival_date }}
					    </div>
						<div class="cell large-6 medium-6 small-12">
							<label>Status: </label>					
							<select name="upd_status" id="upd_status" style="background-color:#cacaca;">
								<option value=""> -- No Selection -- </option>
								{% for sstatus in status_vals %}
									{% if sstatus.wos_auto_key == upd_status %}
									<option value="{{ sstatus.wos_auto_key }}" selected>{{ sstatus.name }}</option>
									{% else %}
									<option value="{{ sstatus.wos_auto_key }}">{{ sstatus.name }}</option>
									{% endif %}
									
								{% endfor %}
							</select>
						</div>
						<div class="cell large-6  medium-6 small-12 mro-searchbuttonbox">
						  <input style="float:left;" class="primary button shadow" type="submit" value="Update" name="wo_update" id="wo_update" onclick="this.disabled=true,this.form.submit();"/>
						</form>	
						<form method="POST" id="bom_sched_form" name="bom_sched_form"> 
						  {% csrf_token %}
						  <input type="hidden" name="woo_sched_list" id="woo_sched_list"/>
						  <input type="hidden" name="bom_sched_val" id="bom_sched_val" value="1"/>
						  <input type="hidden" name="update_user" id="update_user" value="{{ update_user }}"/>
						  <input type="hidden" name="update_session" id="update_session" value="{{ update_session }}"/>
						  <input style="float:left;margin-left:80px;" class="secondary button shadow" type="submit" name="bom_sched" id="bom_sched" value="Schedule" onclick="this.disabled=true,this.form.submit();"> 
						</form>
						</div>
                      </div>
                    </div>
				</div>
				<div class="large-6 small-12 cell">
				  <div class="grid-x grid-padding-x align-middle mro-searchbuttonbox">
                  </div>
                </div>
              </div>
			{% endif %}
		</div>      
	</div>
  </div>
	<script>
	$(function() {
		$("#errorModal").modal();//if you want you can have a timeout to hide the window after x seconds
	});
	</script>
    <!-- Modal -->
    {%  if error %}
      <div class="modal fade" id="errorModal" role="dialog" data-backdrop="static">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
		    <form method="POST" id="modal_error_form" name="modal_error_form">
            <div class="modal-header">
              <button type="button" class="close" id="x_button" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Application Message:</h4>
            </div>
            <div class="modal-body">
			    {%  if error %}<input type="hidden" id="error" name="error" value="{{ error }}"/><div style="font-weight: bold; color:red; font-size: 22px;">{{ error }}</div>{%  endif %}
                <button class="secondary button shadow" id="ok_button" style="float:right; margin-top:-20px;" type="button" data-dismiss="modal">OK</button>
                <div><br/><br/></div>			
            </div>
			</form>
          </div>                
       </div>
      </div>
	  {% endif %}  
    <!-- End modal error popup --> 
	<div class="mro-bottom-section-wrapper mro-table">
      <div class="grid-container mro-bottom-section">
	      <div class="grid-x grid-padding-x">
				{% if all_woos %}
					<div class="centered results_grid" id="results_grid" name="results_grid">
					<div class="counter_wrap">					  
					  <button type="button" id="select_all" class="secondary button shadow" style="margin-left:-45px;padding:9px;">SELECT ALL</button><input type="text" class="sel_rows" id="sel_rows" name="sel_rows" size="4" value="{{ sel_rows }}" readonly>of     <input type="text" class="total_rows" id="total_rows" name="total_rows" value="{{ total_rows }}" size="5" readonly>
					  <!--span class="k-pager-info k-label"/-->
					</div>			
			<script>
			kendo.ui.Grid.prototype._positionColumnResizeHandle= function() {
			  var that = this,
				  indicatorWidth = that.options.columnResizeHandleWidth,
				  lockedHead = that.lockedHeader ? that.lockedHeader.find("thead:first") : $();

			  that.thead.add(lockedHead).on("mousemove" + ".kendoGrid", "th", function (e) {
				var th = $(this);
				if (th.hasClass("k-group-cell") || th.hasClass("k-hierarchy-cell")) {
				  return;
				}
				that._createResizeHandle(th.closest("div"), th);
			  });
			};
			var oldPageSize = 0;
			$( "#select_all" ).click(function() {
			  //alert( "Handler for .click() called." );
			    var grid = $("#results_grid").data("kendoGrid");
				//oldPageSize = grid.dataSource.pageSize();
				//grid.dataSource.pageSize(grid.dataSource.data().length);

				if (grid.dataSource.data().length === grid.select().length) {
					grid.clearSelection();
					$("input[type=hidden][class='woos_stale']").remove(); 
					$("input[type=hidden][class='woos']").remove();	
					$('#sel_rows').val(0);
				} 
				else {
					grid.select("tr");
				};

				//grid.dataSource.pageSize(oldPageSize);
			});

			function onChange(e) {
				var rows = e.sender.select();
				var grid = $("#results_grid").data("kendoGrid");
				var currentPage = grid.dataSource.page();
				rows.each(function(e) {
					var dataItem = grid.dataItem(this);					
					var row_item = $('input[type=hidden][class="woos"][value=' + dataItem.id + ']').length;
                    if (!row_item) {
						var inputWoo = '<input type="hidden" uipage="' + currentPage + '" name="woos_list[]" id="woos_list[]" class="woos" value="' + dataItem.id + '" checked=checked"/>';
						var inputSched = '<input type="hidden" uipage="' + currentPage + '" name="woos_list[]" id="woos_list[]" class="woo_sched" value="' + dataItem.id + '" checked=checked"/>';
						$('#filter_session').after(inputWoo);
						$('#bom_sched_val').after(inputSched);						
					}
				var count = $("input[type=hidden][class='woos']").length;
				$('#sel_rows').val(count);						
				});
			};
			$(document).ready(
				function () {
				    //$("span[class='k-icon k-i-file-excel']").attr('class','secondary button shadow');
 					//set the filter_ field vals to their 'active_' counter parts
					if (!$('#new_status').val() && $('#filter_status').val()) {
						$('#new_status').val($('#filter_status').val())
					}
					if (!$('#get_due_date').val() && $('#filter_due_date').val()) {
						$('#get_due_date').val($('#filter_due_date').val())
					}
					if (!$('#customer').val() && $('#filter_customer').val()) {
						$('#customer').val($('#filter_customer').val())
					}
					if (!$('#wo_number').val() && $('#filter_number').val()) {
						$('#wo_number').val($('#filter_number').val())
					}
					if (!$('#get_manager').val() && $('#filter_manager').val()) {
						$('#get_manager').val($('#filter_manager').val())
					}				
					var dataSourceArguments = {	
					    autoBind: false,
						pageSize: 2000,
						serverPaging: true,
						serverSorting: true,
						transport: {
							read: {
								url: '/portal/json',
								dataType: "json",
								data: { 'user_id': '{{ user_id }}','session_id': '{{ session_id }}','is_wos': '1' } // the parameter I need to send to the server
							}
						},
						schema: {
							total: "count",
							data: "results",
							model: { id: "woo_auto_key" },
						}
					}
					
					var dsg = new kendo.data.DataSource(dataSourceArguments);
					var options = localStorage["grid-options"];
					$("#results_grid").kendoGrid({
					    toolbar: ["excel"],
						excel: {
							fileName: "wo-management-export.xlsx",
							proxyURL: "https://demos.telerik.com/kendo-ui/service/export",
							allPages: true
						},
						dataSource: dsg,
						sortable: true,
						reorderable: true,
						resizable: true,
						columnMenu: true,
                        selectable: "multiple, row",
						persistSelection: true,
                        //navigatable: true,
						change: onChange,
						pageable: {
							refresh: true,
							pageSizes: true,
							buttonCount: 5,
						},
                        columns: [					
							{
							  field: 'wo_number',
							  title: 'WO#',
							  width: screen.availWidth*0.05,
							  template : '<a target=\"_blank\"href=\"/portal/wo-mgmt-detail/#=quapi_id#/#=woo_auto_key#/#=session_id#/#=wo_number#\">#=wo_number#</a>'
							},
							{
							  field: 'part_number',
							  title: 'PN',
							  width: screen.availWidth*0.05
							},
							{
							  field: 'description',
							  title: 'Desc',
							  width: screen.availWidth*0.05
							},
							{
							  field: 'status',
							  title: 'Status',
							  width: screen.availWidth*0.05
							},
							{
							  field: 'quantity',
							  title: 'QTY',
							  width: screen.availWidth*0.03
							},
							{
							  field: 'exp_date',
							  title: 'Est. Comp.',
                              template: '#= kendo.toString(kendo.parseDate(exp_date), "MM/dd/yyyy")#',
                              width: screen.availWidth*0.05					  
							},
							{
							  field: 'due_date',
							  title: 'Due',
                              template: '#= kendo.toString(kendo.parseDate(due_date), "MM/dd/yyyy")#',
                              width: screen.availWidth*0.05					  
							},
							{
							  field: 'rank',
							  title: 'Rank',
							  width: screen.availWidth*0.04
							},
							{
							  field: 'manager',
							  title: 'Mgr',
							  width: screen.availWidth*0.04
							},
							{
							  field: 'location_code',
							  title: 'Loc',
							  width: screen.availWidth*0.04
							},
							{
							  field: 'loc_validated_date',
							  title: 'Updated',
							  template: '#= kendo.toString(kendo.parseDate(loc_validated_date), "M/dd/yyyy HH:mm:ss")#',
							  width: screen.availWidth*0.05
							},
							{
							  field: 'serial_number',
							  title: 'Serial #',
							  width: screen.availWidth*0.05
							},
							{
							  field: 'customer',
							  title: 'Cust',
							  width: screen.availWidth*0.05
							},
							{
							  field: 'notes',
							  title: 'In Work',
							  template: '<img src="/static/#=notes#"/>',
							  width: screen.availWidth*0.05
							}
                        ]							
					});
					$("select[data-role='dropdownlist']").kendoDropDownList({
						dataTextField: "pageSize",
						dataValueField: "sizeValue",
						dataSource: [
							{pageSize: 25},
							{pageSize: 50},
							{pageSize: 100},
							{pageSize: 500},
							{pageSize: 2000},
							{pageSize: 'All', sizeValue:10000},
						],
					});
					var grid = $("#results_grid").data("kendoGrid");
					if (options) {
					    var pers_options = JSON.parse(options);
                        //console.log(pers_options.excel.fileName);
					    if (pers_options.excel.fileName == 'wo-management-export.xlsx') {
						    grid.setOptions(pers_options);
							grid.setOptions({
							    'dataSource':dsg,
							});
					    }
                    }
					 
				    window.onbeforeunload = function() {
						localStorage["grid-options"] = kendo.stringify(grid.getOptions());

						return;
					}
				});
			  </script>
	            </div>	
			{% endif %}
		  </div>
        <div class="grid-x mro-pagination-section">
          <div class="cell large-5 medium-6 small-12 ">
            <a class="mrotop" href="#mrotop" data-smooth-scroll><span>^</span> Back to Top</a>
          </div>
        </div>		  
	    </div>
	  </div>
   
				
<div class="mro-footer-wrapper">
	<div class="grid-container mro-footer">
		<div class="grid-x">
			<div class="cell small-12">
				<img class="mro-footerlogo" src="{% static 'dist/assets/img/mro-live_header.png' %}" alt="Where Productivity Takes Flight" alt="MRO Live - Where Productivity Takes Flight">
			</div>
		</div>

		<div class="grid-x mro-footer-bottom">
			<div class="cell medium-5 small-12 mro-footer-bottom-left">
				<p>Copyright &copy; 2025 MRO Live <span>|</span> <img class="mro-usa" src="{% static 'dist/assets/img/usa.png' %}" alt="Based in USA">Based in USA</p>
			</div>
		</div>
	</div>
</div><script src="{% static 'dist/assets/js/app.js' %}"></script>
</body>
</html>
